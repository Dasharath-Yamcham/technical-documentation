# 005. Labsquire â€” Environment Variable Management Documentation

## 1. Purpose of Environment Variable Management

This document describes how environment variables are securely maintained for Labsquire across Development, QA/Staging, and Production environments. Environment variables store sensitive system configuration values and must be handled with strict security practices.

## 2. No Environment Files in Git Repositories

Environment files must never be committed to GitHub. They contain sensitive credentials including database passwords, API keys, authentication secrets, and internal service keys. All `.env` files must be included in `.gitignore` to prevent accidental exposure.

**Required `.gitignore` rules:**

- `.env`
- `.env.*`

## 3. Separate Environment Files Per Environment

Each environment operates independently and requires its own environment configuration file. These files must exist only on the respective EC2 servers and must not be stored or shared through GitHub.

**Environment file structure:**

- `.env.dev` (Development)
- `.env.qa` (QA / Stage)
- `.env.prod` (Production)

## 4. Server Storage Locations

Environment files are stored securely inside the application's environment directory on each server.

- **DEV Server:** `/home/ubuntu/labsquire/env/.env.dev`
- **QA / Stage Server:** `/home/ubuntu/labsquire/env/.env.qa`
- **Production Server:** `/home/ubuntu/labsquire/env/.env.prod`

## 5. PM2 Environment Variable Loading

PM2 must be configured to load the correct environment file depending on the environment being deployed. The PM2 ecosystem file should map each environment to its corresponding `.env` file.

## 6. Workflow Handling of Environment Variables

GitHub Actions does not store or push `.env` files. During deployment, the workflow updates application code and restarts the service, while each server loads its local `.env` file automatically.

**DEV & QA Deployment Workflow:**

- The `.env` file already exists on the server.
- Workflow updates code and reloads PM2.
- PM2 automatically loads environment variables.

**Production Deployment Workflow:**

- Uses GitHub Secrets for sensitive values.
- No `.env` file is transferred from GitHub.
- Production values remain isolated and secure on the server.

## 7. Maintaining Consistent Variable Names

Variable names must be consistent across all environments. Each environment may have different values, but the variable naming convention must remain identical. This ensures that application logic does not require code changes when switching environments.

## 8. Updating Environment Variables

When adding or modifying environment variables:

1. Add the new variable name to all environment files.
2. Provide correct values per environment.
3. Restart PM2 after updates to apply changes.
4. Never reuse production keys in development or QA environments.