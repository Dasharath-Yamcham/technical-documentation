# 012. Unified Production-Grade Node.js Project Structure  
*(ExpressJS & NestJS – Team Standard)*

- **Status**: In-Review  
- **Date**: 2025-12-22  
- **Owner**: Sai Durga Masabattula
- **Audience:** All Backend Engineers

This document defines a **production-ready, opinionated, and scalable project structure** to be followed across **all backend applications**.  
It covers **architecture, best practices, tooling, testing, performance, logging, Swagger, and environment management**.

---

## Why This Structure
- Consistency across teams and services
- Easier onboarding
- Clear ownership boundaries
- Production-grade observability and quality
- Scales from monolith → microservices

---

## High-Level Folder Structure

```
your-project/
├── src/
│   ├── modules/                     # Feature-based modules
│   │   └── user/
│   │       ├── user.controller.ts
│   │       ├── user.service.ts
│   │       ├── user.repository.ts
│   │       ├── user.dto.ts
│   │       ├── user.types.ts
│   │       ├── user.routes.ts        # Express only
│   │       ├── user.module.ts        # NestJS only
│   │       └── index.ts              # Express barrel
│   ├── common/
│   │   ├── middlewares/
│   │   ├── utils/
│   │   │   ├── logger.ts
│   │   │   ├── request-context.ts    # correlation / requestId
│   │   │   └── helpers.ts
│   │   ├── types/                    # shared global types
│   │   ├── constants/
│   │   ├── errors/
│   │   │   └── global-error.handler.ts
│   │   └── validators/
│   ├── config/
│   │   ├── env.ts                    # dotenv + validation
│   │   ├── db.config.ts
│   │   ├── app.config.ts
│   │   └── swagger.config.ts
│   ├── models/                       # DB models (ORM / ODM)
│   ├── app.ts                        # Express bootstrap
│   └── main.ts                       # NestJS bootstrap
├── tests/
│   ├── unit/
│   ├── integration/
│   └── e2e/
├── performance/
│   ├── jmeter/
│   │   ├── README.md
│   │   ├── test-plans/
│   │   │   └── orders-load-test.jmx
│   │   ├── data/
│   │   │   └── users.csv
│   │   └── reports/
├── .env
├── .env.development
├── .env.staging
├── .env.production
├── .env.example
├── .eslintrc.js
├── .prettierrc
├── package.json
├── tsconfig.json
└── README.md
```

---

## Architecture Principles (Non‑Negotiable)

- **Module-based design only**
- No business logic in controllers
- No DB access in controllers
- Services own business rules
- Repositories own DB access
- Shared logic goes into `common/`
- Snapshot data in orders (never mutable)

---

## Environment Management

- Use `dotenv`
- Load env by `NODE_ENV`
- Validate envs at startup (Joi / Zod)
- Maintain `.env.example` (no secrets)

---

## Logging & Observability

**Mandatory**
- Use `winston` or `pino`
- Central logger: `common/utils/logger.ts`
- Structured logs (JSON)
- Include `requestId` / correlationId
- Log at service boundaries only

---

## Swagger / API Documentation

**Express**
- `swagger-jsdoc`
- `swagger-ui-express`

**NestJS**
- `@nestjs/swagger`

**Rules**
- Swagger setup lives in `config/swagger.config.ts`
- Swagger must be enabled for all APIs
- DTOs drive Swagger definitions

---

## Code Quality & Formatting

### ESLint (Mandatory)
- Catch bugs early
- Enforce standards
- Shared team config

### Prettier
- Auto-format code
- Zero style debates

---

## Testing Strategy

### Framework
- **Jest** (mandatory)

### Types
- Unit tests
- Integration tests (API + DB)
- E2E tests (critical flows)

### Structure
- `/tests` mirrors `/src`
- No logic without tests

---

## Performance Testing (JMeter)

**Why JMeter**
- Easy to visualize
- Widely adopted
- Non-developer friendly

**Structure**
- All load tests under `/performance/jmeter`
- Test plans (`.jmx`)
- CSV-based test data
- Generated reports committed optionally

---

## Security Best Practices

- Never store plain passwords
- Use bcrypt / argon2
- Validate inputs (DTOs)
- Helmet (Express) / security headers
- Rate limiting on public APIs
- Hide stack traces in prod

---

## CI / CD Expectations

- Lint on every PR
- Tests must pass
- Build must succeed
- Swagger must generate
- No direct prod pushes

---

## Final Note

This structure is **the baseline standard** for all backend applications.  
Any deviation must be discussed and agreed upon.


