# 008.Task: Implement Prometheus & Grafana for Monitoring and Set Up Centralized PM2 Log Access

## Details

- Configure Prometheus + Grafana dashboards for system metrics.
- Collect PM2 and server logs using Loki and Promtail.

## Procedure

### 1. Setting up Prometheus and Grafana

- Created EC2 server with Ubuntu AMI and named it as a monitoring-server.
- Connected to the server using SSH client.
- Installed Prometheus using a script.
- Added the server IP of the application server to the Prometheus config file.
- Installed Grafana on the monitoring server.
- Installed node-exporter on the application server.
- Accessed Grafana on port 3000 and Prometheus on port 9090 via browser.
- Logged into Grafana with username `admin` and password `admin`.
- Created a new dashboard in Grafana.
- Provided Prometheus URL in Grafana.
- Imported dashboard by providing ID.
- Viewed application server metrics.

### 2. Setting up Loki and Promtail

- Installed Loki on the monitoring server using a script.
- Enabled the Loki service and accessed it on port 3100.
- Installed Promtail on the application server.
- Accessed Promtail on port 9080.
- Created a datasource in Grafana by selecting Loki.
- Provided Loki URL and added a panel for Loki.
- Queried to collect PM2 logs.
- Applied changes to view PM2 logs in the panel.

## Screenshots

- **Grafana Explore**: `43.205.207.61:3000/explore`
- **Promtail Service Discovery**: `13.200.201.132:9080/targets#job-pm2-logs`

### Log Files

- `/home/ubuntu/.pm2/logs/api-itdose-dev-error.log`
- `/home/ubuntu/.pm2/logs/api-itdose-dev-out.log`
- `/home/ubuntu/.pm2/logs/api-yoda-clm-error.log`
- `/home/ubuntu/.pm2/logs/api-yoda-clm-out.log`
- `/home/ubuntu/.pm2/logs/api-yoda-dnadecoder-error.log`
- `/home/ubuntu/.pm2/logs/api-yoda-dnadecoder-out.log`
- `/home/ubuntu/.pm2/logs/api-yoda-reports-error-4.log`
- `/home/ubuntu/.pm2/logs/api-yoda-reports-error-5.log`
- `/home/ubuntu/.pm2/logs/api-yoda-reports-out-4.log`

### Log Output

```
2025-10-31 15:19:24 2025-10-31 09:49 +00:00: [GlobalExceptionHandler] METHOD: POST, URL: /familymembers/GetAllFamilyMembersByUser/1900a1bc-4d5a-47d0-8300-5fb9776a7440, STATUS: 404, MESSAGE: No Members Found
2025-10-31 15:19:22 2025-10-31 09:49 +00:00: Bucket without CDN: mr-yoda-dev.s3.ap-south-1.amazonaws.com
2025-10-31 15:19:22 2025-10-31 09:49 +00:00: Bucket without CDN: mr-yoda-dev.s3.ap-south-1.amazonaws.com
2025-10-31 15:19:22 2025-10-31 09:49 +00:00: Bucket without CDN: mr-yoda-dev.s3.ap-south-1.amazonaws.com